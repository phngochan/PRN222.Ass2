@page
@model DetailsModel
@{
    ViewData["Title"] = "Chi tiết User";
}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h4><i class="fas fa-user-circle"></i> Chi tiết Người dùng</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="d-flex align-items-center mb-4">
                                <div class="avatar-circle me-3">
                                    <i class="fas fa-user fa-2x text-primary"></i>
                                </div>
                                <div>
                                    <h3 class="mb-1">@Model.ViewModel.Name</h3>
                                    <span class="badge bg-@(GetRoleBadgeClass(Model.ViewModel.Role)) fs-6">
                                        @Model.ViewModel.RoleName
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="info-section">
                                <h6 class="section-title">
                                    <i class="fas fa-info-circle text-primary"></i> Thông tin cơ bản
                                </h6>
                                <table class="table table-borderless">
                                    <tr>
                                        <td width="30%" class="fw-bold">ID:</td>
                                        <td>@Model.ViewModel.Id</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Tên:</td>
                                        <td>@Model.ViewModel.Name</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Email:</td>
                                        <td>
                                            <a href="mailto:@Model.ViewModel.Email" class="text-decoration-none">
                                                <i class="fas fa-envelope me-1"></i>@Model.ViewModel.Email
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Số điện thoại:</td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(Model.ViewModel.Phone))
                                            {
                                                <a href="tel:@Model.ViewModel.Phone" class="text-decoration-none">
                                                    <i class="fas fa-phone me-1"></i>@Model.ViewModel.Phone
                                                </a>
                                            }
                                            else
                                            {
                                                <span class="text-muted">Chưa cập nhật</span>
                                            }
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="info-section">
                                <h6 class="section-title">
                                    <i class="fas fa-building text-success"></i> Thông tin công việc
                                </h6>
                                <table class="table table-borderless">
                                    <tr>
                                        <td width="30%" class="fw-bold">Role:</td>
                                        <td>
                                            <span class="badge bg-@(GetRoleBadgeClass(Model.ViewModel.Role))">
                                                @Model.ViewModel.RoleName
                                            </span>
                                            <div class="small text-muted">
                                                @GetRoleDescription(Model.ViewModel.Role)
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Dealer:</td>
                                        <td>
                                            @if (!string.IsNullOrEmpty(Model.ViewModel.DealerName))
                                            {
                                                <span class="text-primary">
                                                    <i class="fas fa-building me-1"></i>@Model.ViewModel.DealerName
                                                </span>
                                            }
                                            else
                                            {
                                                <span class="text-muted">Không thuộc dealer nào</span>
                                            }
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-4 pt-3 border-top">
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a asp-page="Index" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Quay lại danh sách
                            </a>

                            @if (Request.Cookies["UserRole"] == "1" ||
                            (Request.Cookies["UserRole"] == "2" && Model.ViewModel.Role == 3))
                            {
                                <a asp-page="Edit" asp-route-id="@Model.ViewModel.Id" class="btn btn-warning">
                                    <i class="fas fa-edit"></i> Chỉnh sửa
                                </a>
                            }

                            @if (Request.Cookies["UserRole"] == "1")
                            {
                                <a asp-page="Delete" asp-route-id="@Model.ViewModel.Id" class="btn btn-danger">
                                    <i class="fas fa-trash"></i> Xóa User
                                </a>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Additional Information Cards -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-chart-bar text-info"></i> Thống kê hoạt động
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-md-4">
                                    <div class="stat-item">
                                        <h4 class="text-primary">0</h4>
                                        <small class="text-muted">Đơn hàng đã tạo</small>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="stat-item">
                                        <h4 class="text-success">0</h4>
                                        <small class="text-muted">Khách hàng phụ trách</small>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="stat-item">
                                        <h4 class="text-info">N/A</h4>
                                        <small class="text-muted">Lần đăng nhập cuối</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@functions {
    public string GetRoleBadgeClass(int role)
    {
        return role switch
        {
            1 => "danger",   // Admin - Red
            2 => "warning",  // Manager - Yellow
            3 => "info",     // Staff - Blue
            _ => "secondary" // Unknown - Gray
        };
    }

    public string GetRoleDescription(int role)
    {
        return role switch
        {
            1 => "Quản trị viên hệ thống - Toàn quyền",
            2 => "Quản lý - Quản lý nhân viên và vận hành",
            3 => "Nhân viên - Xử lý đơn hàng và khách hàng",
            _ => "Vai trò không xác định"
        };
    }
}

<style>
    .avatar-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 3px solid #e9ecef;
    }

    .info-section {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    .section-title {
        color: #495057;
        font-weight: 600;
        margin-bottom: 15px;
        padding-bottom: 8px;
        border-bottom: 2px solid #dee2e6;
    }

    .stat-item {
        padding: 15px;
        border-radius: 8px;
        background-color: #ffffff;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        margin-bottom: 10px;
    }

        .stat-item h4 {
            margin-bottom: 5px;
            font-weight: bold;
        }
</style>
